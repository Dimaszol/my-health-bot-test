{% extends "base.html" %}

{% block title %}{{ t('menu_dashboard', lang) }} - {{ t('site_title', lang) }}{% endblock %}

{% block content %}

<!-- üëã –ü–†–ò–í–ï–¢–°–¢–í–ò–ï -->
<div style="margin-bottom: 3rem;">
    <h1 style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">
        {{ t('dashboard_welcome', lang) }}, <span class="gradient-text">{{ user.name }}</span>! üëã
    </h1>
    <p style="color: var(--text-secondary); font-size: 1.1rem;">
        {{ t('dashboard_subtitle', lang) }}
    </p>
</div>

<!-- üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê (–ö–∞—Ä—Ç–æ—á–∫–∏) -->
<div class="card-grid" style="margin-bottom: 3rem;">
    <!-- –î–æ–∫—É–º–µ–Ω—Ç—ã -->
    <div class="stat-card">
        <div class="card-icon">üìÑ</div>
        <div class="stat-number">{{ stats.total_documents }}</div>
        <p style="color: var(--text-secondary); font-weight: 600;">{{ t('stats_documents_uploaded', lang) }}</p>
        <p style="color: var(--text-light); font-size: 0.9rem; margin-top: 0.5rem;">
            {{ t('stats_documents_left', lang) }}: <strong style="color: var(--primary-color);">{{ stats.documents_left }}</strong>
        </p>
        <a href="/dashboard/documents" class="btn btn-outline" style="margin-top: 1rem; padding: 8px 20px; font-size: 0.9rem;">
            {{ t('btn_upload_document', lang) }}
        </a>
    </div>
    
    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    <div class="stat-card">
        <div class="card-icon">üí¨</div>
        <div class="stat-number">{{ stats.total_messages }}</div>
        <p style="color: var(--text-secondary); font-weight: 600;">{{ t('stats_messages', lang) }}</p>
        <p style="color: var(--text-light); font-size: 0.9rem; margin-top: 0.5rem;">
            {{ t('stats_queries_left', lang) }}: <strong style="color: var(--primary-color);">{{ stats.queries_left }}</strong>
        </p>
        <a href="/dashboard/chat" class="btn btn-outline" style="margin-top: 1rem; padding: 8px 20px; font-size: 0.9rem;">
            {{ t('btn_open_chat', lang) }}
        </a>
    </div>
    
    <!-- –¢–∞—Ä–∏—Ñ -->
    <div class="stat-card" style="background: var(--gradient-hero); border: 2px solid var(--primary-color);">
        <div class="card-icon">‚ú®</div>
        <h3 style="font-size: 1.5rem; margin: 1rem 0;">Free Plan</h3>
        <p style="color: var(--text-secondary); font-weight: 600;">{{ t('stats_current_plan', lang) }}</p>
        <a href="#" class="btn" style="margin-top: 1rem; padding: 8px 20px; font-size: 0.9rem;">
            {{ t('btn_upgrade_plan', lang) }} ‚Üí
        </a>
    </div>
</div>

<!-- üìä –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø -->
<div style="margin-bottom: 3rem;">
    <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">
        {{ t('quick_actions', lang) }}
    </h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
        <!-- –ß–∞—Ç —Å AI -->
        <a href="/dashboard/chat" class="card" style="text-decoration: none; cursor: pointer; transition: all 0.3s;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 2.5rem;">üí¨</div>
                <div>
                    <h4 style="color: var(--text-primary); margin-bottom: 0.3rem;">{{ t('action_ask_ai', lang) }}</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">{{ t('action_ask_ai_desc', lang) }}</p>
                </div>
            </div>
        </a>
        
        <!-- –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç -->
        <a href="/dashboard/documents" class="card" style="text-decoration: none; cursor: pointer;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 2.5rem;">üì§</div>
                <div>
                    <h4 style="color: var(--text-primary); margin-bottom: 0.3rem;">{{ t('btn_upload_document', lang) }}</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">{{ t('action_upload_desc', lang) }}</p>
                </div>
            </div>
        </a>
        
        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <a href="/dashboard/profile" class="card" style="text-decoration: none; cursor: pointer;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 2.5rem;">üë§</div>
                <div>
                    <h4 style="color: var(--text-primary); margin-bottom: 0.3rem;">{{ t('action_profile', lang) }}</h4>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">{{ t('action_profile_desc', lang) }}</p>
                </div>
            </div>
        </a>
    </div>
</div>

<!-- üìú –ü–û–°–õ–ï–î–ù–Ø–Ø –ê–ö–¢–ò–í–ù–û–°–¢–¨ -->
<div>
    <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--text-primary);">
        {{ t('recent_activity', lang) }}
    </h2>
    
    {% if recent_chats %}
        <div class="card">
            <h3 style="margin-bottom: 1rem;">üí¨ {{ t('recent_questions', lang) }}</h3>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                {% for chat in recent_chats %}
                <div style="padding: 1rem; background: var(--background-light); border-radius: var(--radius-sm); border-left: 3px solid var(--primary-color);">
                    <p style="color: var(--text-primary); margin-bottom: 0.5rem;">
                        <strong>{{ t('you', lang) }}:</strong> {{ chat.message[:100] }}{% if chat.message|length > 100 %}...{% endif %}
                    </p>
                    <p style="color: var(--text-light); font-size: 0.85rem;">
                        {{ chat.timestamp.strftime('%d.%m.%Y –≤ %H:%M') if chat.timestamp else t('recently', lang) }}
                    </p>
                </div>
                {% endfor %}
            </div>
            <a href="/dashboard/chat" style="display: inline-block; margin-top: 1rem; color: var(--primary-color); font-weight: 600; text-decoration: none;">
                {{ t('go_to_chat', lang) }} ‚Üí
            </a>
        </div>
    {% else %}
        <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
        <div class="alert alert-info">
            <div style="text-align: center; padding: 2rem;">
                <div style="font-size: 4rem; margin-bottom: 1rem;">ü§ñ</div>
                <h3 style="margin-bottom: 0.5rem;">{{ t('start_ai_conversation', lang) }}</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    {{ t('ask_first_question', lang) }}
                </p>
                <a href="/dashboard/chat" class="btn">
                    {{ t('btn_open_chat', lang) }} üí¨
                </a>
            </div>
        </div>
    {% endif %}
</div>

<!-- üí° –ü–û–î–°–ö–ê–ó–ö–ò -->
<div style="margin-top: 3rem;">
    <div class="alert alert-warning">
        <h4 style="margin-bottom: 0.5rem;">üí° {{ t('tip_of_day', lang) }}</h4>
        <p>
            {{ t('tip_upload_docs', lang) }}
        </p>
    </div>
</div>

{% endblock %}

{% block extra_styles %}
<style>
    /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è dashboard */
    .stat-card {
        animation: fadeInUp 0.5s ease;
        animation-fill-mode: both;
    }
    
    .stat-card:nth-child(1) {
        animation-delay: 0.1s;
    }
    
    .stat-card:nth-child(2) {
        animation-delay: 0.2s;
    }
    
    .stat-card:nth-child(3) {
        animation-delay: 0.3s;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}