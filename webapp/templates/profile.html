{% extends "base.html" %}

{% block title %}{{ t('page_profile_title', lang) }} - {{ t('site_title', lang) }}{% endblock %}

{% block content %}
<!-- üë§ –°–¢–†–ê–ù–ò–¶–ê –ü–†–û–§–ò–õ–Ø -->

<div style="margin-bottom: 2rem;">
    <h1 style="color: #667eea;">üë§ {{ t('page_profile_title', lang) }}</h1>
    <p style="color: #666;">
        {{ t('page_profile_subtitle', lang) }}
    </p>
</div>

<!-- üìä –û–°–ù–û–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø -->
<div class="card">
    <h3>{{ t('profile_basic_info', lang) }}</h3>
    
    <div style="margin-top: 1.5rem;">
        <div style="display: grid; grid-template-columns: 200px 1fr; gap: 1rem; margin-bottom: 1rem;">
            <strong>{{ t('profile_name', lang) }}:</strong>
            <span>{{ user.name if user else t('profile_not_specified', lang) }}</span>
        </div>
        
        <div style="display: grid; grid-template-columns: 200px 1fr; gap: 1rem; margin-bottom: 1rem;">
            <strong>{{ t('profile_email', lang) }}:</strong>
            <span>{{ user.email if user else t('profile_not_specified', lang) }}</span>
        </div>
        
        <div style="display: grid; grid-template-columns: 200px 1fr; gap: 1rem; margin-bottom: 1rem;">
            <strong>{{ t('profile_registered', lang) }}:</strong>
            <span>{{ user.created_at.strftime('%d.%m.%Y') if user and user.created_at else t('unknown', lang) }}</span>
        </div>
    </div>
</div>

<!-- üè• –ú–ï–î–ò–¶–ò–ù–°–ö–ê–Ø –ê–ù–ö–ï–¢–ê -->
<div class="card">
    <h3>{{ t('profile_medical_form', lang) }}</h3>
    <p style="color: #666; margin-bottom: 1.5rem;">
        {{ t('profile_medical_form_desc', lang) }}
    </p>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
        <!-- –í–æ–∑—Ä–∞—Å—Ç -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_birth_year', lang) }}</strong>
            <span style="color: #666;">{{ user.birth_year if user and user.birth_year else t('profile_not_specified', lang) }}</span>
        </div>
        
        <!-- –ü–æ–ª -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_gender', lang) }}</strong>
            <span style="color: #666;">{{ user.gender if user and user.gender else t('profile_not_specified', lang) }}</span>
        </div>
        
        <!-- –†–æ—Å—Ç -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_height', lang) }}</strong>
            <span style="color: #666;">
                {% if user and user.height_cm %}
                    {{ user.height_cm }} {{ t('profile_height_unit', lang) }}
                {% else %}
                    {{ t('profile_not_specified', lang) }}
                {% endif %}
            </span>
        </div>
        
        <!-- –í–µ—Å -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_weight', lang) }}</strong>
            <span style="color: #666;">
                {% if user and user.weight_kg %}
                    {{ user.weight_kg }} {{ t('profile_weight_unit', lang) }}
                {% else %}
                    {{ t('profile_not_specified', lang) }}
                {% endif %}
            </span>
        </div>
    </div>
    
    <!-- –•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è -->
    <div style="margin-top: 1.5rem;">
        <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_chronic_conditions', lang) }}</strong>
        <p style="color: #666; padding: 1rem; background: white; border-radius: 8px;">
            {{ user.chronic_conditions if user and user.chronic_conditions else t('profile_not_specified', lang) }}
        </p>
    </div>
    
    <!-- –ê–ª–ª–µ—Ä–≥–∏–∏ -->
    <div style="margin-top: 1.5rem;">
        <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_allergies', lang) }}</strong>
        <p style="color: #666; padding: 1rem; background: white; border-radius: 8px;">
            {{ user.allergies if user and user.allergies else t('profile_not_specified', lang) }}
        </p>
    </div>
    
    <!-- –õ–µ–∫–∞—Ä—Å—Ç–≤–∞ -->
    <div style="margin-top: 1.5rem;">
        <strong style="display: block; margin-bottom: 0.5rem;">{{ t('profile_medications', lang) }}</strong>
        <p style="color: #666; padding: 1rem; background: white; border-radius: 8px;">
            {{ user.medications if user and user.medications else t('profile_not_specified', lang) }}
        </p>
    </div>
</div>

<!-- üîÑ –û–ë–†–ê–ó –ñ–ò–ó–ù–ò -->
<div class="card">
    <h3>{{ t('profile_lifestyle', lang) }}</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
        <!-- –ö—É—Ä–µ–Ω–∏–µ -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">üö¨ {{ t('profile_smoking', lang) }}</strong>
            <span style="color: #666;">{{ user.smoking if user and user.smoking else t('profile_not_specified', lang) }}</span>
        </div>
        
        <!-- –ê–ª–∫–æ–≥–æ–ª—å -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">üç∑ {{ t('profile_alcohol', lang) }}</strong>
            <span style="color: #666;">{{ user.alcohol if user and user.alcohol else t('profile_not_specified', lang) }}</span>
        </div>
        
        <!-- –§–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å -->
        <div>
            <strong style="display: block; margin-bottom: 0.5rem;">üèÉ {{ t('profile_physical_activity', lang) }}</strong>
            <span style="color: #666;">{{ user.physical_activity if user and user.physical_activity else t('profile_not_specified', lang) }}</span>
        </div>
    </div>
</div>

<!-- ‚ÑπÔ∏è –ò–ù–§–û–†–ú–ê–¶–ò–Ø -->
<div class="alert alert-info">
    <strong>üí° {{ t('profile_how_to_fill', lang) }}</strong><br>
    {{ t('profile_fill_instruction', lang) }}
</div>

<!-- üóëÔ∏è –£–î–ê–õ–ï–ù–ò–ï –î–ê–ù–ù–´–• -->
<div class="card" style="border-left-color: #dc3545;">
    <h3 style="color: #dc3545;">‚ö†Ô∏è {{ t('profile_danger_zone', lang) }}</h3>
    <p style="color: #666; margin: 1rem 0;">
        {{ t('profile_delete_warning', lang) }}
    </p>
    <button 
        onclick="confirmDelete()"
        class="btn btn-danger"
    >
        üóëÔ∏è {{ t('profile_delete_account', lang) }}
    </button>
</div>

{% endblock %}

{% block extra_scripts %}
<script>
function confirmDelete() {
    const confirmed = confirm(
        '‚ö†Ô∏è {{ t("warning", lang) }}!\n\n' +
        '{{ t("confirm_delete_account_message", lang) }}\n\n' +
        '{{ t("will_be_deleted", lang) }}:\n' +
        '‚Ä¢ {{ t("all_documents", lang) }}\n' +
        '‚Ä¢ {{ t("chat_history", lang) }}\n' +
        '‚Ä¢ {{ t("medical_profile", lang) }}\n' +
        '‚Ä¢ {{ t("profile", lang) }}\n\n' +
        '{{ t("action_irreversible", lang) }}!'
    );
    
    if (confirmed) {
        const doubleConfirm = confirm('{{ t("double_confirm_message", lang) }}');
        
        if (doubleConfirm) {
            alert('{{ t("delete_feature_coming_soon", lang) }}');
            // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API endpoint –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
        }
    }
}
</script>
{% endblock %}